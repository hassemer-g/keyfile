/* esm.sh - @noble/hashes@2.0.1/hkdf */
import{hmac as m}from"./hmac.mjs";import{abytes as A,ahash as y,anumber as U,clean as l}from"./utils.mjs";function w(t,r,e){return y(t),e===void 0&&(e=new Uint8Array(t.outputLen)),m(t,e,r)}var p=Uint8Array.of(0),f=Uint8Array.of();function x(t,r,e,n=32){y(t),U(n,"length");let o=t.outputLen;if(n>255*o)throw new Error("Length must be <= 255*HashLen");let s=Math.ceil(n/o);e===void 0?e=f:A(e,void 0,"info");let a=new Uint8Array(s*o),u=m.create(t,r),d=u._cloneInto(),i=new Uint8Array(u.outputLen);for(let c=0;c<s;c++)p[0]=c+1,d.update(c===0?f:i).update(e).update(p).digestInto(i),a.set(i,o*c),u._cloneInto(d);return u.destroy(),d.destroy(),l(i,p),a.slice(0,n)}var E=(t,r,e,n,o)=>x(t,w(t,r,e),n,o);export{x as expand,w as extract,E as hkdf};
//# sourceMappingURL=hkdf.mjs.map

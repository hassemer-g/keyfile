/* esm.sh - @noble/hashes@2.0.1/blake1 */
import{BSIGMA as b,G1s as T,G2s as k}from"./_blake.mjs";import{SHA224_IV as K,SHA256_IV as I,SHA384_IV as V,SHA512_IV as tt}from"./_md.mjs";import*as x from"./_u64.mjs";import{abytes as Z,aexists as $,aoutput as st,clean as F,createHasher as z,createView as j}from"./utils.mjs";var E=new Uint32Array(8),P=class{finished=!1;length=0;pos=0;destroyed=!1;buffer;view;salt;blockLen;outputLen;lengthFlag;counterLen;constants;constructor(h,s,l,e,i,n,o={}){let{salt:a}=o;if(this.blockLen=h,this.outputLen=s,this.lengthFlag=l,this.counterLen=e,this.buffer=new Uint8Array(h),this.view=j(this.buffer),a!==void 0){let d=a;Z(d,4*i,"salt");let u=this.salt=new Uint32Array(i),v=j(d);this.constants=n.slice();for(let r=0,p=0;r<u.length;r++,p+=4)u[r]=v.getUint32(p,!1),this.constants[r]^=u[r]}else this.salt=E,this.constants=n}update(h){$(this),Z(h);let{view:s,buffer:l,blockLen:e}=this,i=h.length,n;for(let o=0;o<i;){let a=Math.min(e-this.pos,i-o);if(a===e){for(n||(n=j(h));e<=i-o;o+=e)this.length+=e,this.compress(n,o);continue}l.set(h.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===e&&(this.length+=e,this.compress(s,0,!0),this.pos=0)}return this}destroy(){this.destroyed=!0,this.salt!==E&&F(this.salt,this.constants)}_cloneInto(h){h||=new this.constructor,h.set(...this.get());let{buffer:s,length:l,finished:e,destroyed:i,constants:n,salt:o,pos:a}=this;return h.buffer.set(s),h.constants=n.slice(),h.destroyed=i,h.finished=e,h.length=l,h.pos=a,h.salt=o.slice(),h}clone(){return this._cloneInto()}digestInto(h){$(this),st(h,this),this.finished=!0;let{buffer:s,blockLen:l,counterLen:e,lengthFlag:i,view:n}=this;F(s.subarray(this.pos));let o=BigInt((this.length+this.pos)*8),a=l-e-1;s[this.pos]|=128,this.length+=this.pos,this.pos>a&&(this.compress(n,0),F(s),this.pos=0),s[a]|=i,n.setBigUint64(l-8,o,!1),this.compress(n,0,this.pos!==0),F(s);let d=j(h),u=this.get();for(let v=0;v<this.outputLen/4;++v)d.setUint32(v*4,u[v])}digest(){let{buffer:h,outputLen:s}=this;this.digestInto(h);let l=h.slice(0,s);return this.destroy(),l}},M=Uint32Array.from([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731,3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113]),J=M.slice(0,16),ht=I.slice(),it=K.slice(),et=V.slice(),lt=tt.slice();function nt(){let c=[];for(let h=0,s=0;h<14;h++,s+=16)for(let l=1;l<16;l+=2)c.push(J[b[s+l]]),c.push(J[b[s+l-1]]);return new Uint32Array(c)}var U=nt(),y=new Uint32Array(16),W=class extends P{v0;v1;v2;v3;v4;v5;v6;v7;constructor(h,s,l,e={}){super(64,h,l,8,4,J,e),this.v0=s[0]|0,this.v1=s[1]|0,this.v2=s[2]|0,this.v3=s[3]|0,this.v4=s[4]|0,this.v5=s[5]|0,this.v6=s[6]|0,this.v7=s[7]|0}get(){let{v0:h,v1:s,v2:l,v3:e,v4:i,v5:n,v6:o,v7:a}=this;return[h,s,l,e,i,n,o,a]}set(h,s,l,e,i,n,o,a){this.v0=h|0,this.v1=s|0,this.v2=l|0,this.v3=e|0,this.v4=i|0,this.v5=n|0,this.v6=o|0,this.v7=a|0}destroy(){super.destroy(),this.set(0,0,0,0,0,0,0,0)}compress(h,s,l=!0){for(let G=0;G<16;G++,s+=4)y[G]=h.getUint32(s,!1);let e=this.v0|0,i=this.v1|0,n=this.v2|0,o=this.v3|0,a=this.v4|0,d=this.v5|0,u=this.v6|0,v=this.v7|0,r=this.constants[0]|0,p=this.constants[1]|0,g=this.constants[2]|0,f=this.constants[3]|0,{h:B,l:H}=x.fromBig(BigInt(l?this.length*8:0)),A=(this.constants[4]^H)>>>0,D=(this.constants[5]^H)>>>0,S=(this.constants[6]^B)>>>0,_=(this.constants[7]^B)>>>0;for(let G=0,L=0,m=0;G<14;G++)({a:e,b:a,c:r,d:A}=T(e,a,r,A,y[b[L++]]^U[m++])),{a:e,b:a,c:r,d:A}=k(e,a,r,A,y[b[L++]]^U[m++]),{a:i,b:d,c:p,d:D}=T(i,d,p,D,y[b[L++]]^U[m++]),{a:i,b:d,c:p,d:D}=k(i,d,p,D,y[b[L++]]^U[m++]),{a:n,b:u,c:g,d:S}=T(n,u,g,S,y[b[L++]]^U[m++]),{a:n,b:u,c:g,d:S}=k(n,u,g,S,y[b[L++]]^U[m++]),{a:o,b:v,c:f,d:_}=T(o,v,f,_,y[b[L++]]^U[m++]),{a:o,b:v,c:f,d:_}=k(o,v,f,_,y[b[L++]]^U[m++]),{a:e,b:d,c:g,d:_}=T(e,d,g,_,y[b[L++]]^U[m++]),{a:e,b:d,c:g,d:_}=k(e,d,g,_,y[b[L++]]^U[m++]),{a:i,b:u,c:f,d:A}=T(i,u,f,A,y[b[L++]]^U[m++]),{a:i,b:u,c:f,d:A}=k(i,u,f,A,y[b[L++]]^U[m++]),{a:n,b:v,c:r,d:D}=T(n,v,r,D,y[b[L++]]^U[m++]),{a:n,b:v,c:r,d:D}=k(n,v,r,D,y[b[L++]]^U[m++]),{a:o,b:a,c:p,d:S}=T(o,a,p,S,y[b[L++]]^U[m++]),{a:o,b:a,c:p,d:S}=k(o,a,p,S,y[b[L++]]^U[m++]);this.v0=(this.v0^e^r^this.salt[0])>>>0,this.v1=(this.v1^i^p^this.salt[1])>>>0,this.v2=(this.v2^n^g^this.salt[2])>>>0,this.v3=(this.v3^o^f^this.salt[3])>>>0,this.v4=(this.v4^a^A^this.salt[0])>>>0,this.v5=(this.v5^d^D^this.salt[1])>>>0,this.v6=(this.v6^u^S^this.salt[2])>>>0,this.v7=(this.v7^v^_^this.salt[3])>>>0,F(y)}},t=new Uint32Array(32),w=new Uint32Array(32);function ot(){let c=[];for(let h=0,s=0;h<16;h++,s+=16)for(let l=1;l<16;l+=2)c.push(M[b[s+l]*2+0]),c.push(M[b[s+l]*2+1]),c.push(M[b[s+l-1]*2+0]),c.push(M[b[s+l-1]*2+1]);return new Uint32Array(c)}var Y=ot();function C(c,h,s,l,e,i){let n=2*b[i],o=e[n+1]^Y[i*2+1],a=e[n]^Y[i*2],d=t[2*c+1],u=t[2*c],v=t[2*h+1],r=t[2*h],p=t[2*s+1],g=t[2*s],f=t[2*l+1],B=t[2*l],H=x.add3L(d,v,o);u=x.add3H(H,u,r,a)>>>0,d=(H|0)>>>0,{Dh:B,Dl:f}={Dh:B^u,Dl:f^d},{Dh:B,Dl:f}={Dh:x.rotr32H(B,f),Dl:x.rotr32L(B,f)},{h:g,l:p}=x.add(g,p,B,f),{Bh:r,Bl:v}={Bh:r^g,Bl:v^p},{Bh:r,Bl:v}={Bh:x.rotrSH(r,v,25),Bl:x.rotrSL(r,v,25)},t[2*c+1]=d,t[2*c]=u,t[2*h+1]=v,t[2*h]=r,t[2*s+1]=p,t[2*s]=g,t[2*l+1]=f,t[2*l]=B}function X(c,h,s,l,e,i){let n=2*b[i],o=e[n+1]^Y[i*2+1],a=e[n]^Y[i*2],d=t[2*c+1],u=t[2*c],v=t[2*h+1],r=t[2*h],p=t[2*s+1],g=t[2*s],f=t[2*l+1],B=t[2*l],H=x.add3L(d,v,o);u=x.add3H(H,u,r,a),d=H|0,{Dh:B,Dl:f}={Dh:B^u,Dl:f^d},{Dh:B,Dl:f}={Dh:x.rotrSH(B,f,16),Dl:x.rotrSL(B,f,16)},{h:g,l:p}=x.add(g,p,B,f),{Bh:r,Bl:v}={Bh:r^g,Bl:v^p},{Bh:r,Bl:v}={Bh:x.rotrSH(r,v,11),Bl:x.rotrSL(r,v,11)},t[2*c+1]=d,t[2*c]=u,t[2*h+1]=v,t[2*h]=r,t[2*s+1]=p,t[2*s]=g,t[2*l+1]=f,t[2*l]=B}var q=class extends P{v0l;v0h;v1l;v1h;v2l;v2h;v3l;v3h;v4l;v4h;v5l;v5h;v6l;v6h;v7l;v7h;constructor(h,s,l,e={}){super(128,h,l,16,8,M,e),this.v0l=s[0]|0,this.v0h=s[1]|0,this.v1l=s[2]|0,this.v1h=s[3]|0,this.v2l=s[4]|0,this.v2h=s[5]|0,this.v3l=s[6]|0,this.v3h=s[7]|0,this.v4l=s[8]|0,this.v4h=s[9]|0,this.v5l=s[10]|0,this.v5h=s[11]|0,this.v6l=s[12]|0,this.v6h=s[13]|0,this.v7l=s[14]|0,this.v7h=s[15]|0}get(){let{v0l:h,v0h:s,v1l:l,v1h:e,v2l:i,v2h:n,v3l:o,v3h:a,v4l:d,v4h:u,v5l:v,v5h:r,v6l:p,v6h:g,v7l:f,v7h:B}=this;return[h,s,l,e,i,n,o,a,d,u,v,r,p,g,f,B]}set(h,s,l,e,i,n,o,a,d,u,v,r,p,g,f,B){this.v0l=h|0,this.v0h=s|0,this.v1l=l|0,this.v1h=e|0,this.v2l=i|0,this.v2h=n|0,this.v3l=o|0,this.v3h=a|0,this.v4l=d|0,this.v4h=u|0,this.v5l=v|0,this.v5h=r|0,this.v6l=p|0,this.v6h=g|0,this.v7l=f|0,this.v7h=B|0}destroy(){super.destroy(),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}compress(h,s,l=!0){for(let e=0;e<32;e++,s+=4)w[e]=h.getUint32(s,!1);if(this.get().forEach((e,i)=>t[i]=e),t.set(this.constants.subarray(0,16),16),l){let{h:e,l:i}=x.fromBig(BigInt(this.length*8));t[24]=(t[24]^e)>>>0,t[25]=(t[25]^i)>>>0,t[26]=(t[26]^e)>>>0,t[27]=(t[27]^i)>>>0}for(let e=0,i=0;e<16;e++)C(0,4,8,12,w,i++),X(0,4,8,12,w,i++),C(1,5,9,13,w,i++),X(1,5,9,13,w,i++),C(2,6,10,14,w,i++),X(2,6,10,14,w,i++),C(3,7,11,15,w,i++),X(3,7,11,15,w,i++),C(0,5,10,15,w,i++),X(0,5,10,15,w,i++),C(1,6,11,12,w,i++),X(1,6,11,12,w,i++),C(2,7,8,13,w,i++),X(2,7,8,13,w,i++),C(3,4,9,14,w,i++),X(3,4,9,14,w,i++);this.v0l^=t[0]^t[16]^this.salt[0],this.v0h^=t[1]^t[17]^this.salt[1],this.v1l^=t[2]^t[18]^this.salt[2],this.v1h^=t[3]^t[19]^this.salt[3],this.v2l^=t[4]^t[20]^this.salt[4],this.v2h^=t[5]^t[21]^this.salt[5],this.v3l^=t[6]^t[22]^this.salt[6],this.v3h^=t[7]^t[23]^this.salt[7],this.v4l^=t[8]^t[24]^this.salt[0],this.v4h^=t[9]^t[25]^this.salt[1],this.v5l^=t[10]^t[26]^this.salt[2],this.v5h^=t[11]^t[27]^this.salt[3],this.v6l^=t[12]^t[28]^this.salt[4],this.v6h^=t[13]^t[29]^this.salt[5],this.v7l^=t[14]^t[30]^this.salt[6],this.v7h^=t[15]^t[31]^this.salt[7],F(t,w)}},N=class extends W{constructor(h={}){super(28,it,0,h)}},O=class extends W{constructor(h={}){super(32,ht,1,h)}},Q=class extends q{constructor(h={}){super(48,et,0,h)}},R=class extends q{constructor(h={}){super(64,lt,1,h)}},at=z(c=>new N(c)),ut=z(c=>new O(c)),ft=z(c=>new Q(c)),dt=z(c=>new R(c));export{N as _BLAKE224,O as _BLAKE256,Q as _BLAKE384,R as _BLAKE512,at as blake224,ut as blake256,ft as blake384,dt as blake512};
//# sourceMappingURL=blake1.mjs.map
